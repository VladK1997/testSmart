!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);n(1),n(2)},function(e,t,n){},function(e,t){const n=document.querySelector(".page"),a=document.querySelectorAll(".col"),r=document.getElementById("cardForm"),c=document.getElementById("search"),o=document.getElementById("confirm"),s=document.getElementById("delAllcards"),l=document.getElementById("cardRedactor"),i=o.querySelector("form"),d=l.querySelector(".operation__msg"),u=o.querySelector(".confirm-popup__msg span"),f="https://jsonbox.io/box_b282a1326a5c5dba1ad1";let g={},h=null,v=[];function m(){Object.keys(g).forEach(e=>{g[e].contentBlock.innerHTML=""})}function p(){h.classList.remove("active"),h.querySelector("form").querySelectorAll(".error").forEach(e=>{e.classList.remove("error")}),h=null}function b(){console.log(g.selected.contentBlock.childElementCount),g.selected.counter.innerText=g.selected.contentBlock.childElementCount,g.backlog.counter.innerText=g.backlog.contentBlock.childElementCount,g.running.counter.innerText=g.running.contentBlock.childElementCount,g.evaluation.counter.innerText=g.evaluation.contentBlock.childElementCount,g.live.counter.innerText=g.live.contentBlock.childElementCount}function y(){r.title.value="",r.desc.value="",r.className="card-redactor__form",r.labels.forEach(e=>{e.checked&&(e.checked=!1)}),r.status.forEach(e=>{e.checked&&(e.checked=!1)})}function _(e){return fetch(f+"/"+e._id,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>{!function(e){for(let t=0,n=v.length;t<n;t++)if(v[t]._id===e._id)return Object.assign(v[t],e)}(e)}).catch(e=>(console.log(e),!1))}function E(e){return fetch(f+"/"+e,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(e=>({msg:e.json(),ok:e.ok})).catch(e=>{console.log(e)})}!function(){const e={deleteAllCards:()=>{v.length>0?(n.className+=" page--loading",v.forEach(e=>{E(e._id)}),n.classList.remove("page--loading"),v=[],m(),p()):p()}};s.addEventListener("click",e=>{o.className+=" active",i.action.value="deleteAllCards",console.log(i.action.value),h=o,u.innerText="delete all cards"}),i.addEventListener("submit",t=>{t.preventDefault(),e[i.action.value]()})}(),function(){function e(e){if(console.log(e.iterable),e.length>0&&"string"!==e){let n={};Object.keys(g).forEach(e=>{console.log(e),n[e]=""}),e.forEach(e=>{n[e.status]+=t(e)}),Object.keys(n).forEach(e=>{g[e].contentBlock.insertAdjacentHTML("beforeend",n[e])})}else"object"==typeof e&&g[e.status].contentBlock.insertAdjacentHTML("beforeend",t(e))}function t(e){return'<div class="card" draggable="true" data-cardid="'+e._id+'"><p class="card__title">'+e.title+'</p><div class="card__sett" data-cardRedactor="redact"><svg><use xlink:href="#iconConfig"></use></svg></div><p class="card__desc">'+e.desc+'</p><div class="card__labels">'+a(e.labels)+"</div></div>"}function a(e){let t="";return e.forEach(e=>{t+='<div class="card__label card__label--'+e+'"><span>'+e+"</span></div>"}),t}function o(e){let t=[];return e.length>0&&"string"!=typeof e?(e.forEach(e=>{e.checked&&t.push(e.value)}),t):[]}function s(e){l.className+=" "+e.status,d.innerText=e.msg||"",setTimeout(()=>{y(),p(),l.classList.remove(e.status)},1e3)}fetch(f,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>(v=e,e)).catch(e=>{console.log(e)}).then(t=>{0!==t.length&&e(v)}).then(()=>{b()}).then(()=>{n.classList.remove("page--loading")}),r.title.onchange=e=>{e.target.classList.contains("error")?e.target.classList.remove("error"):0===e.target.value.length&&e.target.classList.add("error")},window.addEventListener("click",t=>{if(t.target.hasAttribute("data-cardRedactor")){let n={redact:"redact"===t.target.dataset.cardredactor,create:"create"===t.target.dataset.cardredactor,createstatus:"createstatus"===t.target.dataset.cardredactor};if(l.className+=" active",h=l,n.redact){let e=t.target,n=e.closest(".card"),c=n.querySelector(".card__title"),l=n.querySelector(".card__desc"),i=n.dataset.cardid;r.className+=" redact",r.title.value=c.innerText,r.desc.value=l.innerText,n.querySelectorAll(".card__label span").forEach(e=>{r.querySelector(".card__label--"+e.innerText+" input").checked=!0}),r.delCard.onclick=e=>{var t;e.preventDefault(),E((t={cardBlock:n,cardId:i}).cardId).then(e=>{if(!e.ok)return console.log(e.msg),void s({status:"error",msg:"string"===e.msg?e.msg:"rejected"});v=v.filter(e=>{if(e._id!==t.cardId)return e}),t.cardBlock.remove(),y(),s({status:"success"})})},r.onsubmit=t=>{t.preventDefault();let d=o(r.labels),u={_id:i,title:r.title.value,desc:r.desc.value,labels:d,status:e.closest(".col").dataset.status};_(u).then(()=>{c.innerText=u.title,l.innerText=u.desc,n.querySelector(".card__labels").innerHTML=a(u.labels)}).then(()=>{s({status:"success"})})}}else if(n.create||n.createstatus){let a,c=t.target;n.createstatus&&(r.className+=" status"),r.onsubmit=t=>{if(t.preventDefault(),r.title.value){if(n.create)a=c.closest(".col").dataset.status;else if(n.createstatus){if(""===r.status.value)return void(r.querySelector(".card-redactor__status-block").className+=" error");console.log("i here"),a=r.status.value}let t={title:r.title.value,desc:r.desc.value,labels:o(r.labels),status:a};(l=t,fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(e=>e.json()).then(e=>e).catch(e=>(console.log(e),!1))).then(t=>{v.push(t),e(t),b()}).then(()=>{s({status:"success"})})}else r.title.classList.contains("error")||(console.log("here title error"),r.title.className+=" error");var l}}}t.target.hasAttribute("data-popupclose")&&(p(),y())}),c.addEventListener("input",t=>{t.preventDefault();let n=[],a=c.search.value.toLowerCase();if(a.length>0){m();for(let e=0,t=v.length;e<t;e++)(v[e].title.toLowerCase().match(a)||v[e].desc.toLowerCase().match(a)||v[e].labels.some(e=>e.toLowerCase().match(a)))&&(console.log(v[e].title),n.push(v[e]));e(n)}else 0===a.length&&(m(),e(v))})}(),function(){let e=null;function t(e){e.className+=" hold",setTimeout((function(){e.className+=" invisible"}),0)}function n(){e.classList.remove("invisible","hold"),e.removeEventListener("dragend",n)}function r(){this.className+=" misty"}function c(){this.classList.remove("misty")}function o(){e&&(this.querySelector("[data-container]").append(e),console.log(e),b(),function(e,t){for(let n=0,a=v.length;n<a;n++)v[n]._id===e.dataset.cardid&&(v[n].status=t,_(v[n]))}(e,this.dataset.status)),this.classList.remove("misty")}a.forEach(e=>{let t=e.dataset.status;g[t]={block:e,contentBlock:e.querySelector(".col__content"),counter:e.querySelector(".col__counter")},console.log(g.backlog.contentBlock),e.addEventListener("dragenter",r,!0),e.addEventListener("dragleave",c),e.addEventListener("dragover",(function(e){e.preventDefault()})),e.addEventListener("drop",o)}),window.addEventListener("mousedown",a=>{if(a.target.draggable||a.target.closest(".card")){var r=a.target.closest(".card");e=r,r.addEventListener("dragstart",e=>{t(r),e.dataTransfer.setData("Text",this.id)}),r.addEventListener("dragend",n)}}),window.addEventListener("mouseup",()=>{e&&(e.removeEventListener("dragstart",t),setTimeout(()=>{e=null},0))})}()}]);